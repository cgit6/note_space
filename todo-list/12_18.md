# 12/18 任務清單

目前 base game 分成 消除掉落、Scatter 計算、算分，共 3 個階段。

## 代辦清單

- [x] 贏分的方式與文件不一致
      [方案]
      修改算分方式，現在要在消除掉落的過程中，先讓 `gmr.TmpAct.Win` 保持為 0 然後在消除掉落後進行結算(加總贏分 x 累積乘數) 最後更新 `gmr.TmpAct`，但是因為前端表演需求，需要在 `ext` 這邊保存符號的累積贏分狀態。

      [實作]
      在 `ext` 多維護一個 `accSymWin int` 屬性值，算分後用 `ext.SymWin` 暫存當前盤面贏分

      現在的衝突是 AddAct 的時候會 更新 `gmr.TmpAct` 裡面的贏分狀態，但是現在不要這樣

      多了 `ext.SymWin` 和 `ext.accSymWin` 需要維護。==注意初始化問題，要想什麼時候需要重置，是每一次 game mode 還是 每一 round。==

      `AddAct` 提交大致分成兩種情況 "盤面改變" 和 "狀態值改變"，以現在這個情況，狀態值改變又分成 "贏分值改變" 與 "乘數值改變"。

      盤面的改變不用 `freezeTempWins()`

      前端 ext 要看到的是在消除掉落階段 贏分符號的變化所以需要累積贏分狀態 但是不需要看到。

- [x] C1 符號的 "贏分計算"與 "判斷觸發 FG"
      [方案]
      在消除掉落階段外處理 C1 符號的 "贏分計算"與 "判斷觸發 FG" 。表演流程上會顯示當所有消除掉落階段(計算贏分符號 -> 處理乘數符號邏輯 -> 補盤) 都結束了之後，再表演 "C1 贏分畫面" 和 "觸發 FG 畫面" 作為最後一動 Step。然後結束這 Round。
      MultiSymPos MultiSymMults AccMulti

- [x] FG 加局沒做
- [x] FG 計算 贏分是 累積贏分 x (盤面乘倍 + 累積乘倍)
      累積乘倍的更新是先算分，再更新累積乘倍

- [ ] SymWin 、 AccSymWin 、 AccMult 初始化時機?
      [方案]
      `SymWin` 是當前 step 的贏分值，每一次 step 都要 reset
      `AccSymWin` 是 每一次 round 的累積贏分，每一 round 都要 reset
      `AccMult` 是 每一次 round 的累積乘數

- [ ] `g.accWin` 算分方式有問題，他會在 round 中重複累積 `ext.AccSymWin * ext.AccMulti`

## 進度

[討論請求] 今日下午 4:30 討論遊戲 code 與 excel 設定檔內容

[問題 1] 昨天下午發現計算贏分的方式與文件不一致
目前算分方式: 每一次消除掉落 當前盤面得分符號 x 累積乘數值
文件算分方式: 所有消除掉落結束後得分符號加總 x 累積乘數值
產生的差異如圖表所示

[問題 2] Scatter 的計分表演是在所有消除掉落結束後還是出現的時候就要表演? 涉及 acts 的安排

昨天跟 Ryan 討論 C1 與 其他得分符號的表演順序問題，結論是 在消除掉落外進行 C1 的計算，所以 paytable 的 C1 要移除，改成 在 Fixed 獨立設定。
[情境]
如果初始盤面已經出現 4 個 Scatter 了(有賠率)，然後經過一番消除掉落，某一次消除掉落又蹦出 1 個 Scatter (賠率更高了)，然後繼續消除掉落數次，結束這回合。

現在會產生兩個問題，就是當 4 個 C1 出現的時候要強制中斷消除掉落馬上進 FG 嗎? 如果

[方案]
在消除掉落階段外處理 C1 符號的 "贏分計算"與 "判斷觸發 FG" 。表演流程上會顯示當所有消除掉落階段(計算贏分符號 -> 處理乘數符號邏輯 -> 補盤) 都結束了之後，再表演 "C1 贏分畫面" 和 "觸發 FG 畫面" 作為最後一動 Step。然後結束這 Round。

之後的工作內容是 -> 再想辦法讓 "當 C1 出現 4 顆以上" 後補盤的符號不要再觸發得分

[工作會報]
早上的工作內容就是要調整算分方式以及 C1 判斷邏輯，excel 設定檔初步填值已經完成。但是我還不是那麼熟悉，所以下午會在檢查一下有沒有缺失。

## 今日重點

- [ ] 移除 `maxWinFlag` 屬性，現在流程改變了，把

## 筆記
